<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    // 수정 전: 전역 변수 5개.
    // anti pattern

    // 생성자 함수 2개
    function Parent() {}
    function Child() {}

    // 변수 1개
    var some_var = 1;

    // 객체 2개
    var module = {};
    module.data = {a: 1, b: 2};
    var module2 = {};

    // - 위의 코드를 리펙토링 하기 위해 먼저 애플리케이션용 전용 전역 객체,
    // - 이를 테면 MYAPP 을 생성한다. 그런 다음 함수와 변수를 전역 객체에 프로퍼티로 변경

    // 수정 후 : 전역 변수 1개

    // 전역객체
    var MYAPP = {};

    // 생성자
    MYAPP.Parent = function() {};
    MYAPP.Child = function () {};

    // 변수
    MYAPP.some_var = 1 ;

    // 객체 컨테이너
    MYAPP.modules = {};

    // 객체들을 컨테이너 안에 추가한다.
    MYAPP.modules.module1 = {};
    MYAPP.modules.module1.data  = {a: 1, b:2};
    MYAPP.modules.module2 = {};

    // ----------------------------------------

    // 범용 네임스페이스 함수를 생성하거나 프러퍼티를 추가하기 전에 먼저 이미 존재하는지 여부를
    // 확인하는 것이 최선이다.

    // 위험
    var MYAPP = {};
    // 개선안
    if (typeof MYAPP === "undefined") {
        var MYAPP = {};
    }
    // 더 짧게..
    var MYAPP = MYAPP || {};

    // 네임스페이스 생성 함수

    var MYAPP = MYAPP || {};

    MYAPP.namespace = function (ns_string) {
        var parts = ns_string.split(','),
            parent = MYAPP,
            i;

        // 처음에 중복되는 전역 객체명은 제거한다
        if (parts[0] === "MYAPP") {
            parts = parts.slice(1);
        }

        for (i = 0; i < parts.length; i += 1) {
            // 프로퍼티가 존재하지 않으면 생성한다.
            if (typeof parent[parts[i] === "undefined") {
                parent[parts[i]] = {};
            }

            parent = parent[parts[i]];
        }
        return parent;
    };

    var module2 = MYAPP.namespace('MYAPP.modules.modules2');
    modules2 === MYAPP.modules.module2; // true



</script>
</body>
</html>